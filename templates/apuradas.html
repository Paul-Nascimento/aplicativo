{% extends 'base.html' %}

{% block content %}





{% for msg in get_flashed_messages() %}
<div class="alert alert-warning alert-dismissible fade show" role="alert">
{{ msg }}
</div>
{% endfor %}

<br/>
<div>
    <h1>Apurar empresas</h1>
</div>
<br/>

<div>
    <form method="POST">

        {{ form.hidden_tag() }}

        {{ form.empresas.label(class="form-label") }}
        {{ form.empresas(class="form-control") }}

        {{ form.responsavel_apuracao.label(class="form-label") }}
        {{ form.responsavel_apuracao(class="form-control") }}

        {{ form.movimento_apuracao.label(class="form-label") }}
        {{ form.movimento_apuracao(class="form-control") }}

        <br/>
        {{ form.apurar(class="btn btn-primary") }}
        {{ form.excluir_apuracao(class="btn btn-danger") }}



    </form>
</div>
<br/>
<div>
    <table class="table table-hover">
        <form method="post">
            <thead>
                <tr>
                    <th> {{ filtro.id.label }}</th>
                    <th>{{ filtro.nome.label}}</th>
                    <th> {{ filtro.grupo.label}}</th>

                    <th>{{ filtro.macro.label}}</th>
                    <th>{{  filtro.regime.label }}</th>
                    <th>{{  filtro.liberacao.label}}</th>
                    <th>{{  filtro.movimento_liberacao.label}}</th>

                    <th>{{  filtro.apuracao.label}}</th>
                    <th>{{  filtro.data_apuracao.label }}</th>
                    <th>{{  filtro.responsavel_apuracao.label }}</th>
                    <th>{{  filtro.movimento_apuracao.label}}</th>
                    <th>{{ filtro.filtrar }}</th>
                </tr>
            <tr>
                    <th> {{ filtro.id(class="form-control") }}</th>
                    <th>{{  filtro.nome(class="form-control")}}</th>
                    <th> {{ filtro.grupo(class="form-control")}}</th>

                    <th>{{  filtro.macro(class="form-control")}}</th>
                    <th>{{  filtro.regime(class="form-control") }}</th>
                    <th>{{  filtro.liberacao(class="form-control")}}</th>
                    <th>{{  filtro.movimento_liberacao(class="form-control")}}</th>

                    <th>{{  filtro.apuracao(class="form-control")}}</th>
                    <th>{{  filtro.data_apuracao(class="form-control") }}</th>
                    <th>{{  filtro.responsavel_apuracao(class="form-control") }}</th>
                    <th>{{  filtro.movimento_apuracao(class="form-control")}}</th>
                </tr>
            </thead>
        </form>

        {% for dado in dados %}
                <tr>
                    <td>{{ dado.id }}</td>
                    <td>{{ dado.nome }}</td>
                    <td>{{ dado.grupo }}</td>
                    <td>{{ dado.macro }}</td>
                    <td>{{ dado.regime }}</td>

                    {% if dado.apuracao == True %}
                         {% if dado.liberacao == 1 %}
                            <td>Sim</td>
                            <td>{{ dado.movimento_liberacao }}</td>
                        {% else %}
                            <td>Não</td>
                            <td></td>
                        {% endif %}
                        <td>Sim</td>

                        <td>{{ dado.data_apuracao|string()}}</td>
                        <td>{{ dado.responsavel_apuracao }}</td>
                        <td>{{ dado.movimento_apuracao }}</td>
                    {% else %}
                        {% if dado.liberacao == True %}
                            <td>Sim</td>
                            <td>{{ dado.movimento_liberacao }}</td>
                        {% else %}
                            <td>Não</td>
                            <td></td>
                        {% endif %}

                        <td>Não</td>
                        <td></td>
                        <td></td>
                        <td></td>
                    {% endif %}


                </tr>
            {% endfor %}


    </table>
</div>



{% endblock %}